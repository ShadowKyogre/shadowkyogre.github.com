<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>My Experiences with ninit [Part 1] | ShadowKyogre's GitHub</title>

    
            <link href="../../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
        <link href="../../assets/css/rst.css" rel="stylesheet" type="text/css">
        <link href="../../assets/css/code.css" rel="stylesheet" type="text/css">
        <link href="../../assets/css/colorbox.css" rel="stylesheet" type="text/css">
        <link href="../../assets/css/theme.css" rel="stylesheet" type="text/css">
            <link href="../../assets/css/custom.css" rel="stylesheet" type="text/css">

    
            <link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">

      <link rel="canonical" href=".">




    
        <!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]-->

    
<link rel="stylesheet" type="text/css" href="../../assets/css/tipuesearch.css">
</head>
<body>
<div id="tipue_search_content" style="margin-left: auto; margin-right: auto; padding: 20px;"></div>



    

    <meta name="author" content="ShadowKyogre">
        <link rel="prev" href="../transferred-github-pages-generator-to-nikola-generated-site/" title="Transferred Github Pages generator to Nikola Generated site" type="text/html">
    
    <meta name="og:title" content="My Experiences with ninit [Part 1]">
    <meta name="og:url" content="/posts/my-experiences-with-ninit-part-1/">
    <meta name="og:description" content="This post is a collection of notes of the process I went through to take out systemd for ninit. Pardon for the scarcity, but I'll revisit this with better descriptions.
What IS ninit?
Preparation

Ins">
    <meta name="og:site_name" content="ShadowKyogre's GitHub">
    <meta name="og:type" content="article">

    

    






<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../../">

                <span id="blog-title">ShadowKyogre's GitHub</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                
                <li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/index.html">Tags</a>
                </li>
<li>
<a href="../../rss.xml">RSS feed</a>
                </li>
<li>
<a href="../../about/index.html">About</a>
            </li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown">Originals<b class="caret"></b></a>
            <ul class="dropdown-menu">
                    <li>
<a href="../../ChronosLNX">ChronosLNX</a>
                    </li>
<li>
<a href="../../QTarot">QTarot</a>
                    </li>
<li>
<a href="../../QArithmancy">QArithmancy</a>
                    </li>
<li>
<a href="../../QBioBeat">QBioBeat</a>
                    </li>
<li>
<a href="../../NCDM">NCDM</a>
                    </li>
<li>
<a href="../../systemd-unit-converter">systemd Unit Converter</a>
                    </li>
<li>
<a href="../../ninit-boot">ninit boot defaults</a>
            </li>
</ul>
            </li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown">Srs Forks<b class="caret"></b></a>
            <ul class="dropdown-menu">
                    <li>
<a href="../../Compiz-Boxmenu">Compiz Boxmenu</a>
                    </li>
<li>
<a href="../../Compiz-Standalone">Compiz Standalone Utils</a>
                    </li>
<li>
<a href="../../openastro-dev">GTK3 port of Openastro</a>
                    </li>
<li>
<a href="../../mikidown">Mikidown</a>
            </li>
</ul>
            </li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown">Forks for Fun<b class="caret"></b></a>
            <ul class="dropdown-menu">
                    <li>
<a href="../../mikidown-personal">Mikidown (personal copy)</a>
                    </li>
<li>
<a href="../../keyboard-tiler">Keyboard Tiler (python port)</a>
                    </li>
<li>
<a href="https://github.com/ShadowKyogre/deepin-screenshot">Deepin Screenshot</a>
                    </li>
<li>
<a href="https://github.com/ShadowKyogre/cdm">CDM</a>
            </li>
</ul>

                
            </li>
</ul>
                <ul class="nav navbar-nav">
<li>
<span class="navbar-form pull-left">
<input type="text" id="tipue_search_input">
</span>
</li>
</ul>


            <ul class="nav navbar-nav navbar-right">
                
                
                    
    <li>
    <a href="index.md" id="sourcelink">Source</a>
    </li>

                
            </ul>
        </div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav>

<!-- End of Menubar -->

<div class="container">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
    
    <header>
        
    <h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">My Experiences with ninit [Part 1]</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">ShadowKyogre</span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2014-09-18T06:13:15-07:00" itemprop="datePublished" title="Publication date">2014-09-18 06:13</time></a></p>
            
        <p class="sourceline"><a href="index.md" id="sourcelink">Source</a></p>

        </div>
        

    </header>

    <div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p>This post is a collection of notes of the process I went through to take out systemd for ninit. Pardon for the scarcity, but I'll revisit this with better descriptions.</p>
<h2 id="what-is-ninit">What IS ninit?</h2>
<h2 id="preparation">Preparation</h2>
<ol>
<li>Install procps-ng-nosystemd</li>
<li>Temporary symlink to systemd-udevd</li>
<li>Install ninit</li>
<li>Set up service directories. You can find a rough copy (though not perfectly synced) copy of my /etc/ninit dir <a href="github.com/shadowkyogre/ninit-boot">here</a>
</li>
<li>Reboot</li>
</ol>
<h2 id="post-install">Post-install</h2>
<h3 id="eudev-systemdcompat">eudev{,-systemdcompat}</h3>
<ol>
<li>manually build eudev and eudev-systemdcompat</li>
<li>Remove the symlink from preparations in systemd</li>
<li>intall eudev and eudev-systemdcompat</li>
<li>Reboot to test things</li>
</ol>
<h3 id="nsvc-o-haltreboot-vs-ninit-shutdown-or">nsvc -o {halt,reboot} vs ninit-shutdown -{o,r}</h3>
<p>I recommend ninit-shutdown -{o,r} if you don't want to manually handle turning services off before<br>
doing shutdown preparations. ninit-shutdown also assumes quite a few things about how a system should<br>
be cleaned up, so if you want more control, you're going to have to create a service to manually shutdown<br>
the services you want in the correct order before halting.</p>
<h3 id="optional-pretty-messages-for-every-section-started">Optional: pretty messages for every section started</h3>
<h3 id="depends-arent-really-depends-more-like-start-before">Depends aren't really "depends" - more like "start before"</h3>
<p>Title says it all. ninit won't actually check if the services that a service depends on have finished executing with success or are running.<br>
Some ways to work around this include:<br>
* Specify the order daemons are started in like /etc/rc.conf, except with /etc/ninit/daemon/depends: Simple enough work around. <br>
Everything's also started in parallel like this.<br>
* Patch ninit to include a separate file for services (opt) that specifies true deps that're only run once OR modifies the depends of certain services<br>
once it's done running: Too complex, but could be done.<br>
* Use setup, rsetup, or sys-rsetup to do the dependency checking for shared dependencies: One of the things that the ninit docs <strong>don't</strong> tell you <br>
is that using nsvc as a synced or waited service is NOT a good idea (nor as a services that's in depends either). I really wouldn't recommend this because this makes things complex.</p>
<h2 id="thoughts">Thoughts</h2>
<p>ninit's good enough if you've got a static configuration that doesn't have too many depends that can be easily manually managed. It also doesn't seem to<br>
keep track of exit codes for error spotting (since a service could fail, but report back as finished).  For true depends, I'd recommend something else <br>
(at least until I can figure out how to patch the run helper in ninit to work around this). I'm thinking of maybe also trying out busybox init+(monit or perp), <br>
initng, OpenRC, or initscripts-fork. Currently, I'm interested in trying monit (even though this'd probably be a little too big for my own needs) since <br>
it does this dependency checking on its own and provides some additional security features that can be coded (eg: stop running a compromised service). <br>
The only thing that scares me about it is that it prefers pid files instead of being a direct parent of the process (as evidenced by with matching|pidfile when<br>
asking what to check for a pid). I just need to figure out which init system to run it from before I start trying it out.</p>
<h2 id="resources">Resources</h2>
<ul>
<li><a href="http://www.linuxfromscratch.org/pipermail/blfs-support/2004-March/049009.html">http://www.linuxfromscratch.org/pipermail/blfs-support/2004-March/049009.html</a></li>
<li><a href="https://github.com/ShadowKyogre/ninit-boot">https://github.com/ShadowKyogre/ninit-boot</a></li>
<li><a href="https://github.com/ShadowKyogre/systemd-unit-converter">https://github.com/ShadowKyogre/systemd-unit-converter</a></li>
</ul>
</div>
    </div>
    <aside class="postpromonav">
    <nav>
    
        <ul itemprop="keywords" class="tags">
           <li><a class="tag p-category" href="../../categories/eudev/" rel="tag">eudev</a></li>
           <li><a class="tag p-category" href="../../categories/ninit/" rel="tag">ninit</a></li>
           <li><a class="tag p-category" href="../../categories/systemd/" rel="tag">systemd</a></li>
        </ul>

    
        <ul class="pager">
            <li class="previous">
                <a href="../transferred-github-pages-generator-to-nikola-generated-site/" rel="prev" title="Transferred Github Pages generator to Nikola Generated site">Previous post</a>
            </li>
        </ul>

    </nav>
    </aside>
    

</article>



        </div>
        <!--End of body content-->

        <footer>
            Contents © 2014         <a href="mailto:shadowkyogre.public@gmail.com">ShadowKyogre</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
    </div>
</div>


            <script src="../../assets/js/jquery.min.js"></script>
            <script src="../../assets/js/bootstrap.min.js"></script>
        <script src="../../assets/js/jquery.colorbox-min.js"></script>
    
<!-- AddToAny BEGIN -->
<a class="a2a_dd" href="http://www.addtoany.com/share_save"><img src="http://static.addtoany.com/buttons/favicon.png" width="16" height="16" border="0" alt="Share"></a>
<script type="text/javascript">
var a2a_config = a2a_config || {};
a2a_config.onclick = 1;
a2a_config.color_main = "06008f";
a2a_config.color_border = "e6005f";
a2a_config.color_link_text = "004dff";
a2a_config.color_link_text_hover = "007ee0";
a2a_config.color_bg = "000a42";
a2a_config.color_arrow = "fff";
a2a_config.color_arrow_hover = "fff";
</script>
<script type="text/javascript" src="//static.addtoany.com/menu/page.js"></script>
<!-- AddToAny END -->


    <script>jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script>
    

<script type="text/javascript" src="../../assets/js/tipuesearch_set.js"></script>
<script type="text/javascript" src="../../assets/js/tipuesearch.js"></script>
<script type="text/javascript">
$(document).ready(function() {
    $('#tipue_search_input').tipuesearch({
        'mode': 'json',
        'contentLocation': '/assets/js/tipuesearch_content.json',
        'showUrl': false
    });
});
</script>



</body>
</html>
